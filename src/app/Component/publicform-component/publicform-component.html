<header class="pf-header">
  <div class="head-center">
    <h1 class="title">{{ brand }}</h1>
  </div>
</header>

<main class="pf-page">

  <div *ngIf="mode === 'loading'" class="pf-card" style="text-align: center; padding: 60px;">
    <div style="font-size: 30px; margin-bottom: 20px;">ğŸ”„</div>
    <p>Verificando link...</p>
  </div>

  <section class="pf-done" *ngIf="mode === 'done'">
    <div class="pf-brand big">{{ brand }}</div>
    <div class="pf-thanks">
      <div class="hotel">{{ hotel }}</div>
      <div class="icon">ğŸ¨</div>
      <div class="msg">AGRADECE A PREFERÃŠNCIA</div>
      <div class="foot">PESQUISA RESPONDIDA EM {{ doneAt }}</div>
    </div>
  </section>

  <div *ngIf="mode === 'error'" class="pf-card" style="text-align: center; padding: 40px; color: #d32f2f;">
    <h3>âš ï¸ Ops!</h3>
    <p>{{ errorMessage }}</p>
  </div>

  <ng-container *ngIf="mode === 'form' || mode === 'review'">
    
    <div class="pf-hotel">{{ formTitle }}</div>
    <div class="pf-form-desc" *ngIf="formDescription">{{ formDescription }}</div>

    <div class="pf-chips" *ngIf="mode === 'form'">
      <button *ngFor="let b of blocks; let i = index" class="chip" [class.done]="i < idx" [class.current]="i === idx"></button>
    </div>

    <section class="pf-card" *ngIf="mode === 'form' && current as b">
      <div class="pf-card-title">
        {{ b.title }} <span *ngIf="b.required" style="color:red">*</span>
      </div>

      <ng-container [ngSwitch]="b.type">
        <ul class="pf-sticker" *ngSwitchCase="'sticker'">
          <li (click)="selectSticker(b.id, 1)" [class.on]="answers[b.id] === 1"><span>ğŸ˜«</span><small>PÃ‰SSIMA</small></li>
          <li (click)="selectSticker(b.id, 2)" [class.on]="answers[b.id] === 2"><span>â˜¹ï¸</span><small>RUIM</small></li>
          <li (click)="selectSticker(b.id, 3)" [class.on]="answers[b.id] === 3"><span>ğŸ˜</span><small>REGULAR</small></li>
          <li (click)="selectSticker(b.id, 4)" [class.on]="answers[b.id] === 4"><span>ğŸ™‚</span><small>BOA</small></li>
          <li (click)="selectSticker(b.id, 5)" [class.on]="answers[b.id] === 5"><span>ğŸ˜„</span><small>EXCELENTE</small></li>
        </ul>
        <div class="pf-slider-wrap" *ngSwitchCase="'bar'">
          <input class="pf-slider" type="range" min="1" max="5" step="1" [value]="answers[b.id] || 3" (input)="onSlider(b.id, $event)" />
          <div class="pf-slider-scale"><span>1</span><span>2</span><span>3</span><span>4</span><span>5</span></div>
        </div>
        <div class="pf-stars" *ngSwitchCase="'stars'">
          <button type="button" *ngFor="let s of [1,2,3,4,5]" class="star" [class.on]="(answers[b.id] || 0) >= s" (click)="selectStars(b.id, s)">â˜…</button>
        </div>
        <div *ngSwitchCase="'text'">
          <textarea class="pf-text" rows="4" placeholder="..." [ngModel]="answers[b.id]" (ngModelChange)="onText(b.id, $event)"></textarea>
        </div>
      </ng-container>

      <div class="pf-actions">
        <button class="pf-btn" (click)="confirm()">CONFIRMAR</button>
      </div>
      <div class="pf-error" *ngIf="requiredError">Responda para continuar.</div>
    </section>

    <section class="pf-review" *ngIf="mode === 'review'">
      <div class="pf-hotel pf-review-title">RevisÃ£o</div>
      <ul class="pf-review-list">
        <li *ngFor="let b of blocks"><span class="tick">âœ“</span> {{ b.title }}</li>
      </ul>
      <div class="pf-actions pf-actions-review">
        <button class="pf-btn" (click)="finish()">ENVIAR</button>
      </div>
    </section>

  </ng-container>
</main>