<div class="viz-page">
  <header class="bar">
    <h1 class="bar-title">PAINEL GERENCIAL DE RESPOSTAS</h1>
    <button class="home-btn" (click)="goHome()" aria-label="Ir para a Home">üè†</button>
  </header>
  <section class="card">
    <div class="card-head">
      <h2 class="card-title">
        Respostas ‚Äì {{ form?.title }}
        (ID: {{ form?.id }})
      </h2>
    </div>
    <div class="card-body meta">
      <div>Criado em: {{ form?.createdAt | date:'dd/MM/yyyy, HH:mm:ss' }}</div>
      <div>‚Ä¢ Total de respostas: {{ form?.totalAnswers || 0 }}</div>
      <div>‚Ä¢ √öltima: {{ form?.lastAnswerAt | date:'dd/MM/yyyy, HH:mm:ss' }}</div>
    </div>
  </section>
  <h3 class="section-title">PERGUNTAS DO FORMUL√ÅRIO</h3>

  <section
    class="card q-card"
    *ngFor="let q of questions"
  >
    <div class="card-head">
      <div class="q-title">{{ q.prompt }}</div>
      <span class="badge">Tipo: {{ q.type }}</span>
    </div>

    <div class="card-body" [ngSwitch]="q.type">
      <ul class="scale-list" *ngSwitchCase="'sticker'">
        <li *ngFor="let i of [0,1,2,3,4]">
          <span class="emo">{{ emojiOf(i) }}</span>
          <span class="lbl">{{ labelOf(i) }}</span>
          <span class="dot">‚Ä¢</span>
          <span class="qty">{{ (stats[q.id]?.counts?.[i] || 0) }}</span>
        </li>
      </ul>

      <ul class="scale-list" *ngSwitchCase="'stars'">
        <li *ngFor="let i of [0,1,2,3,4]">
          <span class="emo">‚òÖ</span>
          <span class="lbl">{{ labelOf(i) }}</span>
          <span class="dot">‚Ä¢</span>
          <span class="qty">{{ (stats[q.id]?.counts?.[i] || 0) }}</span>
        </li>
      </ul>

      <div class="avg-row" *ngSwitchCase="'slider'">
        <div class="avg-label">M√©dia</div>
        <div class="avg-value">{{ stats[q.id]?.avg ?? 0 }}</div>
      </div>
      <div class="texts" *ngSwitchCase="'text'">
        <div class="texts-title">√öltimas respostas</div>
        <ul class="texts-list" *ngIf="(stats[q.id]?.texts?.length || 0) > 0; else noText">
          <li *ngFor="let t of stats[q.id]?.texts">{{ t }}</li>
        </ul>
        <ng-template #noText>
          <div class="empty">Nenhuma resposta</div>
        </ng-template>
      </div>

      <div class="empty" *ngSwitchDefault>Sem dados</div>
    </div>
  </section>
</div>
